# My_tg_bot

## Описание

Этот Телеграм-бот позволяет пользователям отправлять анонимные письма, получать случайные фразы и изображения. Он разработан с использованием библиотеки aiogram для асинхронного взаимодействия с Телеграм API, а также asyncpg для работы с PostgreSQL базой данных.

## Функции

- **Отправка анонимных писем**: Пользователи могут отправлять анонимные письма, которые сохраняются в файле.
- **Получение случайной фразы**: Бот извлекает случайную фразу из базы данных и отправляет её пользователю.
- **Получение случайного изображения**: Бот извлекает случайное изображение из базы данных и отправляет его пользователю.

## Установка

1. **Клонирование репозитория:**
    
    ```
    git clone <URL-репозитория>
    ```
    
2. **Установка зависимостей:**
    
    ```
    pip install -r requirements.txt
    ```
    
3. **Настройка переменных окружения:**
Создайте файл `.env` в корне проекта по примеру.

## Запуск бота

Выполните следующую команду для запуска бота:

```
python <имя_файла>.py
```

## Структура бота

- **Классы состояний (`Form`)**
Определяют различные состояния для работы с ботом.
- **Подключение к базе данных**
Используется asyncpg для создания пула соединений с базой данных.
- **Обработчики команд**
Бот реагирует на команды `/start`, а также на сообщения с определённым текстом для выполнения своих функций.
- **Запуск**
Используется aiogram's executor для запуска и работы бота.

## Примеры команд

- `/start` - начать взаимодействие с ботом.
- Отправка анонимного письма - выберите соответствующую опцию в меню бота и следуйте инструкциям.
- Получение случайной фразы или изображения - выберите соответствующую опцию в меню.


## Обратите внимание

- Убедитесь, что у вас установлен Python 3.7 или выше.
- Все необходимые переменные окружения должны быть корректно установлены в файле `.env`.
- Для работы с базой данных необходимо иметь PostgreSQL.


## Дополнительная Настройка Базы Данных

### Подготовка изображений для Базы Данных

В дополнение к основной функциональности бота, предусмотрена возможность загрузки изображений в базу данных. Это делается с помощью скрипта на Python, который читает файлы изображений из указанной директории и загружает их в базу данных.

### Шаги для загрузки изображений:

1. **Создание директории для изображений:**
Создайте директорию (например, `imgs`), в которую будут помещаться изображения.
2. **Размещение изображений в директории:**
Поместите изображения форматов `.jpg` или `.png` в эту директорию.
3. **Использование скрипта для загрузки изображений:**
Скрипт перебирает все файлы в указанной директории и добавляет их в таблицу `Images` базы данных.

### Обратите внимание:

- Убедитесь, что в базе данных уже создана таблица `Images` с соответствующей структурой.
- Перед выполнением скрипта убедитесь, что все необходимые переменные окружения указаны в файле `.env`.

Этот скрипт расширяет функциональность бота, позволяя ему отправлять пользователю случайные изображения из базы данных.


## Дополнительная Настройка Базы Данных для Фраз

В дополнение к предыдущим настройкам, предусмотрена функциональность для загрузки текстовых фраз в базу данных из текстового файла. Это позволит боту извлекать и отправлять случайные фразы пользователям.

### Шаги для Загрузки Фраз:

1. **Подготовка текстового файла с фразами:**
Создайте текстовый файл (например, `phrases.txt`) и заполните его фразами, разделяя каждую фразу новой строкой.
2. **Использование скрипта для загрузки фраз:**
Скрипт читает текстовый файл, обрабатывает каждую строку и добавляет её в таблицу `phrase` базы данных.

### Обратите внимание:

- Убедитесь, что в базе данных создана таблица `phrase` с соответствующей структурой.
- Проверьте, что все необходимые переменные окружения указаны в файле `.env`.

Этот скрипт расширяет возможности бота, добавляя функцию отправки случайных текстовых фраз, выбранных из предварительно загруженного списка.